{% extends template('widget') %}

{% define data = {
    quote: _widget.quote,
    orderCustomReference: _widget.quote.orderCustomReference,
    orderCustomReferenceForm: _widget.orderCustomReferenceForm,
    isEditable: _widget.isEditable,
} %}

{% block body %}
    {% set canWrite = data.isEditable or can('WriteSharedCartPermissionPlugin', data.quote.idQuote) %}

    {% block orderCustomReference %}
        {% if canWrite %}
            {% block referenceForm %}
                {% include molecule('order-custom-reference-form', 'OrderCustomReferenceWidget') with {
                    data: {
                        form: data.orderCustomReferenceForm
                    },
                } only %}
            {% endblock %}
        {% endif %}

        {% if not canWrite %}
            {% block referenceView %}
                {% include molecule('order-custom-reference-view', 'OrderCustomReferenceWidget') with {
                    data: {
                        orderCustomReference: data.quote.orderCustomReference,
                    },
                } only %}
            {% endblock %}
        {% endif %}
    {% endblock %}
{% endblock %}
